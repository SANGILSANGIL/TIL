

- 먼저 세션이란?

Http에서 말하는 세션(일반적인 페이지 방문)은 Session-Id란 쿠키를 이용해서 서버측에서 저장하는 정보(로그인정보 등)을 뜻함. 
채팅에서의 상태 유지는 WebSocket(SockJS등)을 통해 구현된 Ping-Pong( open→send→close )을 통한 상태유지

but 많은 수의 ping-pong 만으로도 트래픽 과부하를 일으킬수 있지 않을까?

1. 세션 서버가 따로 존재.

2. 사용자가 채팅방을 만들시 세션 서버에서 채팅방을 생성 및 세션값을 사용자에게 전달

3. 다른 사용자가 채팅방에 접근시 해당 채팅방의 세션값을 사용자에게 전달

4. 해당 세션값을 통해 방을 구분하여 메시지 전달



###세션 유지 방법
- 해당 세션과 사용자 정보를 통해 사용아 인증(가짜 사용자 방지)
- 클라이언트에서 ping(ask)하는 방식과 서버에서 ping(ask)하는 방식이 있다. 예전의 web모델에선 ajax를 통해서
시간마다 ping을 했으나 이젠 websocket을 활용한다.
- 서버에서의 ping은 서버에겐 무리한 일을 시키므로 클라이언트가 ping 을 날려 req를 날려 상태를 생긴하며 일정 시간동안
ping 이 없는 사용자는 대기 사용자로 취급한다.
- 대기 사용자가 너무 많으면 굳이 서버에 채팅방을 할당할 필요가 없어지므로 방의 전체가 대기 사용자라면 성능이 낮은 서버로 
채팅방을 옮기며 세션 정보만을 가지고 있다가 사용자를 확인한다. 

![http://wiki.geeekdev.com/lib/exe/fetch.php?cache=&w=900&h=455&tok=4d9701&media=wiki:%EC%8A%A4%ED%81%AC%EB%A6%B0%EC%83%B7_2016-02-17_%EC%98%A4%ED%9B%84_3.56.15.png](http://wiki.geeekdev.com/lib/exe/fetch.php?cache=&w=900&h=455&tok=4d9701&media=wiki:%EC%8A%A4%ED%81%AC%EB%A6%B0%EC%83%B7_2016-02-17_%EC%98%A4%ED%9B%84_3.56.15.png)
